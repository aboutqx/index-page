<div class="container"></div>
<script>
var s=' <ul id="ulWeekVideos" class="hotnews_con mt15">\
	    <li>\
		    <span class="num1">1</span>\
		    <a href="http://movie.mtime.com/216885/trailer/58467.html" class="title" target="_blank">最后的巫师猎人 中文版终极预告片</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/216885/trailer/58467.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/15/094119.72533379_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/216885/trailer/58467.html" target="_blank" class="px14 bold">最后的巫师猎人 中文版终极预告片</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num2">2</span>\
		    <a href="http://movie.mtime.com/203183/trailer/58461.html" class="title" target="_blank">蝙蝠侠大战超人：正义黎明 片段之正面..</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/203183/trailer/58461.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/15/081241.34948390_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/203183/trailer/58461.html" target="_blank" class="px14 bold">蝙蝠侠大战超人：正义黎明 片段之正面对峙</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num3">3</span>\
		    <a href="http://movie.mtime.com/217684/trailer/58535.html" class="title" target="_blank">X特遣队 预告片2</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/217684/trailer/58535.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/20/110831.76481123_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/217684/trailer/58535.html" target="_blank" class="px14 bold">X特遣队 预告片2</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num4">4</span>\
		    <a href="http://movie.mtime.com/83664/trailer/58480.html" class="title" target="_blank">科洛弗道10号 预告片</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/83664/trailer/58480.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/16/104137.42539112_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/83664/trailer/58480.html" target="_blank" class="px14 bold">科洛弗道10号 预告片</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num5">5</span>\
		    <a href="http://movie.mtime.com/228571/trailer/58482.html" class="title" target="_blank">极限挑战 剧场版预告片3</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/228571/trailer/58482.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/16/120209.18372408_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/228571/trailer/58482.html" target="_blank" class="px14 bold">极限挑战 剧场版预告片3</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num6">6</span>\
		    <a href="http://movie.mtime.com/209007/trailer/58499.html" class="title" target="_blank">美人鱼 宣传曲MV《世界只有你好》(演唱..</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/209007/trailer/58499.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/18/160933.25592444_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/209007/trailer/58499.html" target="_blank" class="px14 bold">美人鱼 宣传曲MV《世界只有你好》(演唱：郑少秋 莫文蔚)</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num7">7</span>\
		    <a href="http://movie.mtime.com/231469/trailer/58542.html" class="title" target="_blank">正义联盟黎明 电视宣传片"Wonder Woman"</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/231469/trailer/58542.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/20/142546.54636260_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/231469/trailer/58542.html" target="_blank" class="px14 bold">正义联盟黎明 电视宣传片"Wonder Woman"</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num8">8</span>\
		    <a href="http://movie.mtime.com/221190/trailer/58529.html" class="title" target="_blank">邻居大战2：姐妹会崛起 预告片</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/221190/trailer/58529.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/20/085750.84375433_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/221190/trailer/58529.html" target="_blank" class="px14 bold">邻居大战2：姐妹会崛起 预告片</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num9">9</span>\
		    <a href="http://movie.mtime.com/209007/trailer/58502.html" class="title" target="_blank">美人鱼 主题曲发布会</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/209007/trailer/58502.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/18/202108.87758551_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/209007/trailer/58502.html" target="_blank" class="px14 bold">美人鱼 主题曲发布会</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
	    <li>\
		    <span class="num10">10</span>\
		    <a href="http://movie.mtime.com/223848/trailer/58481.html" class="title" target="_blank">爱宠大机密 角色版预告片之雪球</a>\
		    <div class="table">\
			    <div class="t_r">\
				    <div class="td">\
					    <a href="http://movie.mtime.com/223848/trailer/58481.html" target="_blank" class="imgs_box w120"><img src="http://img31.mtime.cn/mg/2016/01/16/110123.92373824_120X90X4.jpg" class="img_box" />\
					        <em class="ico_hd"></em>\
					    </a>\
				    </div>\
				    <div class="td pl12">\
					    <p>\
						    <a href="http://movie.mtime.com/223848/trailer/58481.html" target="_blank" class="px14 bold">爱宠大机密 角色版预告片之雪球</a>\
					    </p>\
					    \
				    </div>\
			    </div>\
		    </div>\
	    </li>\
    </ul>\
';
//var t=s.match(/(<li>){1}(.|\r|\n)+?(target="_blank">){1}(.|\r|\n)+?(</a>){1}/gm)
var tmp=s.split('</li>');
var movies=[];
var container=document.querySelector('.container');
tmp.forEach(function(v,i){

    if(i==tmp.length-1) return;
    var linkDeptPart=v.split('</a>')[0];
    var link=linkDeptPart.match(/href=".+?"/)[0].substr(5).slice(1,-1);
    var dept=linkDeptPart.match(/_blank\">.+/)[0].substr(8);
    var imgSrc=v.match(/src=".+?"/)[0].substr(4).slice(1,-1);
    var movieId=link.split('/')[3];
    var videoId=link.split('/')[5].slice(0,-5);
    var tmpDate=new Date();
    var tParam=tmpDate.getFullYear()+""+(tmpDate.getMonth()+1)+tmpDate.getDate()+tmpDate.getTime();
    var movieInfoLink='http://api.mtime.com/Service/Video.api?Ajax_CallBack=true&Ajax_CallBackType=Mtime.Api.Pages.VideoService&Ajax_CallBackMethod=GetVideoInfo&Ajax_CrossDomain=1&Ajax_RequestUrl=http://http://video.mtime.com/'+videoId+'/?mid='+movieId+'&t='+tParam+'&Ajax_CallBackArgument0='+videoId;
    
    fetch(movieInfoLink,{credentials: 'include'}).then(function(response){
        return response.text().then(function(text){
          eval(''+text+'');
          load();
        })
    })
    /*
    var tmpScript=document.createElement('script');
    tmpScript.src=movieInfoLink;
    document.body.appendChild(tmpScript);
    */
    tmpScript.onload=load;
    function load(){
      var movieSrc=getVideoInfoResult.value.mp4URL;
	  movies.push({movieSrc:movieSrc,dept:dept,imgSrc:imgSrc});
	  
	  var item=document.createElement('div');
	  item.className='item';
	  container.appendChild(item);
	  var p=document.createElement('p');
	  p.innerHTML=dept;
	  item.appendChild(p);
	  var img=new Image();
	  img.src=imgSrc;
	  var a=document.createElement('a');
	  a.href=movieSrc;
	  a.appendChild(img);
	  item.insertBefore(a,p);
	  console.log(movies);
	}
})
function addMoviesDom(){

}

</script>
<style>
    body{
    	margin: 0;
    	padding: 0;
    }
	.container{
		display: flex;
		flex-direction: column;
        height:900px;
        width:600px;
        margin: 0 auto;
	}
	.item{
        
		flex:1;
		display: flex;
        
	}
	img{
        margin-right: 8px;
		width:120px;
	}
	p{
		flex:1;
	}
</style>
